```
go get -u github.com/pip-services4/pip-services4-go/pip-services4-postgres-go@latest
```

```
data1 := MyData{Id: "1", Key: "key 1", Content: "content 1"}
data2 := MyData{Id: "2", Key: "key 2", Content: "content 2"}
data3 := MyData{Id: "3", Key: "key 3", Content: "content 3"}
```

```
import (
    persist "github.com/pip-services4/pip-services4-go/pip-services4-postgres-go"
)
```

```
import (
	"context"

	cquery "github.com/pip-services4/pip-services4-go/pip-services4-data-go/query"

	persist "github.com/pip-services4/pip-services4-go/pip-services4-postgres-go/persistence"
)

// page structure
type MyDataPage struct {
	Total *int64   `bson:"total" json:"total"`
	Data  []MyData `bson:"data" json:"data"`
}

func NewEmptyMyDataPage() *MyDataPage {
	return &MyDataPage{}
}

func NewMyDataPage(total *int64, data []MyData) *MyDataPage {
	return &MyDataPage{Total: total, Data: data}
}

type MyPostgresPersistence struct {
	*persist.PostgresPersistence[MyData]
}

func NewMyPostgresPersistence() *MyPostgresPersistence {
	c := &MyPostgresPersistence{}
	c.PostgresPersistence = persist.InheritPostgresPersistence[MyData](c, "mydata")
	return c
}

func (c *MyPostgresPersistence) DefineSchema() {
	// clear all previously autogenerated schemas
	c.ClearSchema()
	c.PostgresPersistence.DefineSchema()
	// create a table
	c.EnsureSchema("CREATE TABLE " + c.QuotedTableName() + " (\"id\" TEXT PRIMARY KEY, \"key\" TEXT, \"content\" TEXT)")
	// create an index
	c.EnsureIndex(c.TableName+"_key", map[string]string{"key": "1"}, map[string]string{"unique": "true"})
}

func (c *MyPostgresPersistence) Create(ctx context.Context, correlationId string, item MyData) (result MyData, err error) {
	return c.PostgresPersistence.Create(ctx, item)
}

func (c *MyPostgresPersistence) GetPageByFilter(ctx context.Context, correlationId string, filter string, paging *cquery.PagingParams) (page cquery.DataPage[MyData], err error) {
	return c.PostgresPersistence.GetPageByFilter(ctx, filter, *paging, "", "")
}

func (c *MyPostgresPersistence) GetOneRandom(ctx context.Context, correlationId string, filter string) (item MyData, err error) {
	return c.PostgresPersistence.GetOneRandom(ctx, filter)
}

func (c *MyPostgresPersistence) GetListByFilter(ctx context.Context, correlationId string, filter string) (items []MyData, err error) {
	return c.PostgresPersistence.GetListByFilter(ctx, filter, "", "")
}

func (c *MyPostgresPersistence) GetCountByFilter(ctx context.Context, correlationId string, filter string) (count int64, err error) {
	return c.PostgresPersistence.GetCountByFilter(ctx, filter)
}

func (c *MyPostgresPersistence) DeleteByFilter(ctx context.Context, correlationId string, filter string) (err error) {
	return c.PostgresPersistence.DeleteByFilter(ctx, filter)
}
```

```
import (
    conf "github.com/pip-services4/pip-services4-go/pip-services4-components-go/config"
)

persistence := NewMyPostgresPersistence()
persistence.Configure(context.Background(), conf.NewConfigParamsFromTuples(
	"connection.host", "localhost",
	"connection.port", 5432,
	"connection.database", "pip1",
	"credential.username", "postgres",
	"credential.password", "admin",
))
```

```
err := persistence.Open(context.Background())
```

```
result, _ := persistence.Create(context.Background(), data1)
```

````
result.Id      // Returns '1'
result.Key     // Returns 'key 1'
result.Content // Returns 'content 1'
````

```
result, _ := persistence.GetOneRandom(context.Background(), "", "key='key 1'")
```

```
result.Id      // Returns '1'
result.Key     // Returns 'key 1'
result.Content // Returns 'content 1'
```

```
result, _ := persistence.GetListByFilter(context.Background(), "", "key='key 1'")
```

```
result[0].Id       // Returns '1'
result[0].Key      // Returns 'key 1'
result[0].Content  // Returns 'content 1'
```

```
result, _ := persistence.GetPageByFilter(context.Background(), "", "key='key 1'", nil)
```

```
result.Data[0].Id       // Returns '1'
result.Data[0].Key      // Returns 'key 1'
result.Data[0].Content  // Returns 'content 5'
```

```
result, _ := persistence.GetCountByFilter(context.Background(), "", "key='key 1'") // Returns 1
```

```
err := persistence.DeleteByFilter(context.Background(), "", "key='key 1'")
```

```
import (
    persist "github.com/pip-services4/pip-services4-go/pip-services4-postgres-go"
)
```

```
type MyPostgresPersistence struct {
	persist.IdentifiablePostgresPersistence[MyData, string]
}

func NewMyPostgresPersistence() *MyPostgresPersistence {
	c := &MyPostgresPersistence{}
	c.IdentifiablePostgresPersistence = *persist.InheritIdentifiablePostgresPersistence[MyData, string](c, "mydata")
	return c
}

func (c *MyPostgresPersistence) DefineSchema() {
	c.ClearSchema()
	c.IdentifiablePostgresPersistence.DefineSchema()
	// Row name must be in double quotes for properly case!!!
	c.EnsureSchema("CREATE TABLE " + c.QuotedTableName() + " (\"id\" TEXT PRIMARY KEY, \"key\" TEXT, \"content\" TEXT)")
	c.EnsureIndex(c.TableName+"_key", map[string]string{"key": "1"}, map[string]string{"unique": "true"})
}

func (c *MyPostgresPersistence) Create(ctx context.Context, item MyData) (result MyData, err error) {
	return c.IdentifiablePostgresPersistence.Create(ctx, item)
}

func (c *MyPostgresPersistence) GetPageByFilter(ctx context.Context, filter string, paging cquery.PagingParams) (page cquery.DataPage[MyData], err error) {

	return c.IdentifiablePostgresPersistence.GetPageByFilter(ctx, filter, paging, "", "")
}

func (c *MyPostgresPersistence) GetOneRandom(ctx context.Context, correlationId string, filter string) (item MyData, err error) {
	return c.PostgresPersistence.GetOneRandom(ctx, filter)
}

func (c *MyPostgresPersistence) GetListByFilter(ctx context.Context, correlationId string, filter string) (items []MyData, err error) {
	return c.PostgresPersistence.GetListByFilter(ctx, filter, "", "")
}

func (c *MyPostgresPersistence) GetCountByFilter(ctx context.Context, filter string) (count int64, err error) {
	return c.PostgresPersistence.GetCountByFilter(ctx, filter)
}

func (c *MyPostgresPersistence) DeleteByFilter(ctx context.Context, filter string) (err error) {
	return c.PostgresPersistence.DeleteByFilter(ctx, filter)
}
```

```
import (
    conf "github.com/pip-services4/pip-services4-go/pip-services4-components-go/config"
)

persistence := NewMyPostgresPersistence()
persistence.Configure(context.Background(), conf.NewConfigParamsFromTuples(
	"connection.host", "localhost",
	"connection.port", 5432,
	"connection.database", "pip1",
	"credential.username", "postgres",
	"credential.password", "admin",
))
```

```
err := persistence.Open(context.Background())
```

```
result, _ := persistence.Create(context.Background(), data1)
```

```
result1.Id      // Returns '1'
result1.Key     // Returns 'key 1'
result1.Content // Returns 'content 1'
```

```
result, _ = persistence.GetOneById(context.Background(), "1")
```

```

result.Id       // Returns '1'
result.Key      // Returns 'key 1.1'
result.Content  // Retuns 'content 1'
```

```
idsList := []string{"2", "3"}
result1, _ := persistence.GetListByIds(context.Background(), idsList)
```

```
result[0].Id        // Returns '3'
result[0].Key       // Returns 'key 3'
result[0].Content   // Returns 'content 3'
result[1].Id        // Returns '2'
result[1].Key       // Returns 'key 2'
result[1].Content   // Returns 'content 2'
```

```
result, _ = persistence.Update(context.Background(), MyData{Id: "1", Key: "key 1.1", Content: "new content 1"})
```

```
result.Id       // Returns '1'
result.Key      // Returns 'key 1.1'
result.Content  // Returns 'new content 1'
```

```
import (
    cdata "github.com/pip-services4/pip-services4-go/pip-services4-commons-go/data"
)

result, _ = persistence.UpdatePartially(context.Background(), "1", *cdata.NewAnyValueMap(map[string]interface{}{"content": "new content 1.1"}))
```

```
result.Id      // Returns '1'
result.Key     // Returns 'key 1.1'
result.Content // Returns 'new content 1.1'
```

```
result, _ := persistence.DeleteById(context.Background(), "1")
```

```
idsList := []string{"4", "5"}
err := persistence.DeleteByIds(context.Background(), idsList)
```

```
import (
    persist "github.com/pip-services4/pip-services4-go/pip-services4-postgres-go"
)
```

```
type MyPostgresPersistence struct {
	persist.IdentifiableJsonPostgresPersistence[MyData, string]
}

func NewMyPostgresPersistence() *MyPostgresPersistence {
	c := &MyPostgresPersistence{}
	c.IdentifiableJsonPostgresPersistence = *persist.InheritIdentifiableJsonPostgresPersistence[MyData, string](c, "mydata")
	return c
}

func (c *MyPostgresPersistence) DefineSchema() {
	c.ClearSchema()
	c.IdentifiableJsonPostgresPersistence.DefineSchema()
	c.EnsureTable("", "")
	c.EnsureIndex(c.TableName+"_key", map[string]string{"(data->'key')": "1"}, map[string]string{"unique": "true"})
}

func (c *MyPostgresPersistence) Create(ctx context.Context, item MyData) (result MyData, err error) {
	return c.IdentifiableJsonPostgresPersistence.Create(ctx, item)
}

func (c *MyPostgresPersistence) GetPageByFilter(ctx context.Context, filter string, paging *cquery.PagingParams) (page cquery.DataPage[MyData], err error) {

	return c.IdentifiableJsonPostgresPersistence.GetPageByFilter(ctx,
		filter, *paging,
		"", "")
}

func (c *MyPostgresPersistence) GetOneRandom(ctx context.Context, filter string) (item MyData, err error) {
	return c.PostgresPersistence.GetOneRandom(ctx, filter)
}

func (c *MyPostgresPersistence) GetListByFilter(ctx context.Context, filter string) (items []MyData, err error) {
	return c.PostgresPersistence.GetListByFilter(ctx, filter, "", "")
}

func (c *MyPostgresPersistence) GetCountByFilter(ctx context.Context, filter string) (count int64, err error) {
	return c.PostgresPersistence.GetCountByFilter(ctx, filter)
}

func (c *MyPostgresPersistence) DeleteByFilter(ctx context.Context, filter string) (err error) {
	return c.PostgresPersistence.DeleteByFilter(ctx, filter)
}
```

```
result, _ := persistence.GetOneRandom(context.Background(), "key='key 1'")
```

```
result.Id      // Returns '1'
result.Key     // Returns 'key 1'
result.Content // Returns 'content 1'`
```

```

```
